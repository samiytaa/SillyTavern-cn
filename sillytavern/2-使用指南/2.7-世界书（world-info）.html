<!DOCTYPE html> <html lang="zh-cn"><head>
<title>2.7 世界书（World Info）</title>
<base href="../..">
<meta name="pathname" content="sillytavern/2-使用指南/2.7-世界书（world-info）.html">
<meta name="description" content="SillyTavern - 2.7 世界书（World Info）">
<meta property="og:title" content="2.7 世界书（World Info）">
<meta property="og:description" content="SillyTavern - 2.7 世界书（World Info）">
<meta property="og:type" content="website">
<meta property="og:url" content="sillytavern/2-使用指南/2.7-世界书（world-info）.html">
<meta property="og:image" content="undefined">
<meta property="og:site_name" content="SillyTavern"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0"><meta charset="UTF-8"><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="site-lib/rss.xml"><script async="" id="webpage-script" src="site-lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-wasm-script" src="site-lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="site-lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="site-lib/media/favicon.png"><link rel="stylesheet" href="site-lib/styles/obsidian.css"><link rel="stylesheet" href="site-lib/styles/theme.css"><link rel="preload" href="site-lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="site-lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/main-styles.css"></noscript><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-vertical-spacing:1.3em;--sidebar-margin:12px}:root{background-color:#202124}.sidebar{height:100%;font-size:14px;z-index:10;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));position:relative;overflow:hidden;overflow:clip;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}#left-sidebar{left:0}#right-sidebar{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}.sidebar.floating{position:absolute}.sidebar .leaf-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .leaf-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}#left-sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}#right-sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar #left-sidebar-content,.sidebar #right-sidebar-content{contain:none!important;container-type:normal!important;animation:none!important}.sidebar:has(.leaf-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}#left-sidebar .sidebar-topbar{left:0;flex-direction:row}#right-sidebar .sidebar-topbar{right:0;flex-direction:row-reverse}#left-sidebar .topbar-content{margin-right:calc(2.3em + var(--sidebar-margin));flex-direction:row}#right-sidebar .topbar-content{margin-left:calc(2.3em + var(--sidebar-margin));flex-direction:row-reverse}.topbar-content{overflow:hidden visible;overflow:clip visible;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:2px!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}#left-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}#right-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.feature-title{margin-left:4px;text-transform:uppercase;letter-spacing:.06em;margin-top:.75em;margin-bottom:.75em}.feature-header{display:flex;align-items:center;padding-top:0;font-size:1em;padding-left:0}body.floating-sidebars .sidebar{position:absolute}body{transition:background-color var(--color-fade-speed) ease-in-out}#layout{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}#center-content{flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0!important;transition:opacity .2s ease-in-out;pointer-events:none}#center-content>.obsidian-document{padding-left:2em;padding-right:1em;margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}body #center-content>.obsidian-document>.markdown-preview-sizer{padding-bottom:80vh;width:100%;max-width:var(--line-width);flex-basis:var(--line-width);transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document>div{width:100%!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document:not([data-type=markdown]).embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}#center-content>.obsidian-document:not([data-type=markdown]).embed>*{max-width:100%;max-height:100%;object-fit:contain}:not(h1,h2,h3,h4,h5,h6):has(> :is(.math:not(.math-inline),table)){overflow-x:auto!important}#center-content>.obsidian-document:not([data-type=markdown]){overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.obsidian-document[data-type=attachment]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%}.obsidian-document[data-type=attachment]>*{outline:0;border:none;box-shadow:none}.obsidian-document[data-type=attachment] :is(img){max-width:90%;max-height:90%;object-fit:contain}.obsidian-document[data-type=attachment]>:is(audio){width:100%;max-width:min(90%,var(--line-width))}.obsidian-document[data-type=attachment]>:is(embed,iframe,video){width:100%;height:100%;max-width:100%;max-height:100%;object-fit:contain}.canvas-wrapper>:is(.header,.footer){z-index:100;position:absolute;display:flex;justify-content:center;flex-direction:column;width:100%;align-items:center}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){let e=document.querySelectorAll("link[itemprop='include']");for(const t of e){let e=t.getAttribute("href");try{let o="";if(e.startsWith("https:")||e.startsWith("http:")||"file:"!=window.location.protocol){const l=await fetch(e);if(!l.ok){console.log("Could not include file: "+e),t?.remove();continue}o=await l.text()}else{const t=document.getElementById(btoa(encodeURI(e)));if(t){const e=JSON.parse(decodeURI(atob(t.getAttribute("value")??"")));o=e?.data??""}}let l=document.createRange().createContextualFragment(o),n=Array.from(l.children);for(let e of n)e?.classList?.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e?.classList?.remove("hide")}),10);t.before(l),t.remove(),console.log("Included text: "+o),console.log("Included file: "+e)}catch(o){t?.remove(),console.log("Could not include file: "+e,o);continue}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script")));!function e(l){let n=o[l],c=l+1;n?(n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(c),l<o.length&&n.addEventListener("load",(()=>e(c)))):l<o.length?e(c):t()}(0)}</script></head><body class="publish css-settings-manager is-frameless is-hidden-frameless show-inline-title show-ribbon is-focused"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="parsed-feature-container" style="display: contents;"><link itemprop="include" href="site-lib/html/custom-head-content-content.html"></div><div id="layout"><div id="left-content" class="leaf" style="--sidebar-width: var(--sidebar-width-left);"><div id="left-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><div id="search-container"><div id="search-wrapper"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div aria-label="Clear search" id="search-clear-button"></div></div></div></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="left-sidebar-content" class="leaf-content"><link itemprop="include" href="site-lib/html/file-tree-content.html"></div></div><script defer="">let ls = document.querySelector("#left-sidebar"); ls.classList.toggle("is-collapsed", window.innerWidth < 768); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div></div><div id="center-content" class="leaf"><div class="obsidian-document markdown-preview-view markdown-rendered node-insert-event is-readable-line-width allow-fold-headings show-indentation-guide allow-fold-lists show-properties" data-type="markdown"><style id="MJX-CHTML-styles"></style><pre class="frontmatter language-yaml" tabindex="0" style="display: none;"><code class="language-yaml is-loaded"><span class="token key atrule">title</span><span class="token punctuation">:</span> 世界书（World Info）</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre><div class="markdown-preview-sizer markdown-preview-section"><div class="header"><h1 class="page-title heading inline-title" id="2.7_世界书（World_Info）_0">2.7 世界书（World Info）</h1><div class="data-bar"></div></div><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="el-h1"><h1 data-heading="世界书（World Info）" dir="auto" class="heading" id="世界书（World_Info）_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>世界书（World Info）</h1></div><div class="el-p"><p dir="auto"><strong>世界书（也称为知识库或记忆书）</strong> 是一个强大的工具，可在对话中动态插入提示词（prompt），以帮助引导 AI 的回复。</p></div><div class="el-p"><p dir="auto">通常，世界书（World Info，简称 WI）用于增强 AI 对你虚拟世界细节的理解，但你也可以使用世界书条目插入任何你希望插入的内容。</p></div><div class="el-p"><p dir="auto">它像一个动态的词典，只有在消息文本中出现与条目相关的关键词时，才会插入世界书中的相关信息。</p></div><div class="el-p"><p dir="auto"><em>需要注意的是，虽然世界书有助于引导 AI 朝着期望的内容进行生成，但它并不保证这些信息会出现在生成的输出消息中。这取决于你的模型是否能有效利用附加信息！</em></p></div><div class="el-h1"><h1 data-heading="专业提示" dir="auto" class="heading" id="专业提示_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>专业提示</h1></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>世界书引擎是一个非常强大的提示词管理工具。不要只专注于添加角色背景，也可以进行各种实验。</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>激活关键词、标题以及其他不在<strong>内容</strong>字段中的信息不会被插入到上下文中，因此每个世界书条目应包含简洁且独立的描述。</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span>为了创建丰富而详细的世界背景，条目可以互相交织并通过递归引用彼此。有关更多信息，请参见<a data-tooltip-position="top" aria-label="2.7 世界书（World Info） > 递归扫描" data-href="2.7 世界书（World Info）#递归扫描" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#递归扫描_0" class="internal-link" target="_self" rel="noopener nofollow">递归扫描</a>部分。</li>
<li data-line="3" dir="auto"><span class="list-bullet"></span>SillyTavern 为插入的背景信息提供灵活的上下文预算。为了节省提示词令牌，建议保持条目内容简洁。</li>
</ul></div><div class="el-h1"><h1 data-heading="进一步阅读" dir="auto" class="heading" id="进一步阅读_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>进一步阅读</h1></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://rentry.co/world-info-encyclopedia" rel="noopener nofollow" class="external-link is-unresolved" href="https://rentry.co/world-info-encyclopedia" target="_self">世界书百科全书</a>：关于世界书和知识库的详细指南，由 kingbri、Alicat、Trappu 编写。</li>
</ul></div><div class="el-h1"><h1 data-heading="角色背景资料" dir="auto" class="heading" id="角色背景资料_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>角色背景资料</h1></div><div class="el-p"><p dir="auto">可以选择为角色分配一个世界书（World Info）文件，以便在所有与该角色的对话中（包括群聊）使用该角色的专用背景资料。</p></div><div class="el-p"><p dir="auto">为此，请在角色管理面板中点击地球图标，然后从下拉列表中选择世界书（World Info），然后点击“确定”。</p></div><div class="el-h3"><h3 data-heading="角色背景资料插入策略" dir="auto" class="heading" id="角色背景资料插入策略_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>角色背景资料插入策略</h3></div><div class="el-p"><p dir="auto">在生成 AI 回复时，角色世界书中的条目会与全局世界书中的条目结合，使用以下策略之一：</p></div><div class="el-h4"><h4 data-heading="平均排序（默认）" dir="auto" class="heading" id="平均排序（默认）_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>平均排序（默认）</h4></div><div class="el-p"><p dir="auto">所有条目会按照它们的插入顺序排序，仿佛它们是一个大的文件，忽略来源。</p></div><div class="el-h4"><h4 data-heading="角色背景资料优先" dir="auto" class="heading" id="角色背景资料优先_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>角色背景资料优先</h4></div><div class="el-p"><p dir="auto">角色世界书中的条目将优先插入，按其插入顺序排序，然后插入全局世界书中的条目。</p></div><div class="el-h4"><h4 data-heading="全局背景资料优先" dir="auto" class="heading" id="全局背景资料优先_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>全局背景资料优先</h4></div><div class="el-p"><p dir="auto">全局世界书中的条目将优先插入，按其插入顺序排序，然后插入角色世界书中的条目。</p></div><div class="el-h3"><h3 data-heading="世界书条目" dir="auto" class="heading" id="世界书条目_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>世界书条目</h3></div><div class="el-h4"><h4 data-heading="关键字" dir="auto" class="heading" id="关键字_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>关键字</h4></div><div class="el-p"><p dir="auto">一个触发世界书条目激活的关键字列表。关键字默认不区分大小写（这个是可以配置的）。</p></div><div class="el-h5"><h5 data-heading="正则表达式（Regex）作为关键词" dir="auto" class="heading" id="正则表达式（Regex）作为关键词_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>正则表达式（Regex）作为关键词</h5></div><div class="el-p"><p dir="auto">关键字提供了一种更灵活的匹配方式，支持正则表达式。这使得能够匹配更动态的内容，包括可选的单词或字符、空格以及正则表达式提供的所有其他功能。</p></div><div class="el-p"><p dir="auto">如果定义的关键字是有效的正则表达式（采用 Javascript 正则表达式语法，带有<code>/</code>作为分隔符，所有标志均可使用），它将在检查条目是否应被触发时被作为正则表达式处理。多个正则表达式可以作为单独的关键字输入，并与其他正则表达式一起工作。在正则表达式中，逗号是允许的。普通文本关键字不支持逗号，它们会被当作关键字分隔符处理。</p></div><div class="el-p"><p dir="auto">例如，以下正则表达式适用于与天气相关的条目：</p></div><div class="el-pre"><pre class="language-plain" tabindex="0"><code data-line="0" class="language-plain is-loaded">/(?:\\{\\{char\\}\\}|he|she) (?:is talking about|is noticing|is checking whether|observes) (?:the )?(rainy weather|heavy wind|it is going to rain|cloudy sky)/i;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">有关正则表达式的更多信息，请参考：<a data-tooltip-position="top" aria-label="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_expressions" rel="noopener nofollow" class="external-link is-unresolved" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_expressions" target="_self">Regular expressions - JavaScript | MDN</a></p></div><div class="el-h6"><h6 data-heading="每条消息匹配 高级正则表达式" dir="auto" class="heading" id="每条消息匹配_高级正则表达式_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>每条消息匹配 高级正则表达式</h6></div><div class="el-p"><p dir="auto">ST 在每条聊天消息前都会加上<code>\\{\\{character name\\}\\}:</code>，并且在 v1.12.6 版本之后，使用字符值 1（<code>\\x01</code>）将其连接并预先附加。</p></div><div class="el-p"><p dir="auto">这意味着你可以仅通过正则表达式匹配来自某个特定角色的输入或输出。</p></div><div class="el-p"><p dir="auto">例如，要匹配用户说“hello”，可以使用以下正则表达式：</p></div><div class="el-pre"><pre class="language-plain" tabindex="0"><code data-line="0" class="language-plain is-loaded">/\\x01\\{\\{user\\}\\}:[^\\x01]*?hello/;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h5"><h5 data-heading="关键字输入" dir="auto" class="heading" id="关键字输入_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>关键字输入</h5></div><div class="el-p"><p dir="auto">有两种模式来输入关键字，每种模式稍有不同。在 ⌨️ <em>纯文本模式</em>（默认）下，关键字可以作为逗号分隔的列表输入在一个文本框中。正则表达式也可以包括在内，但没有特别的高亮显示。在 ✨ <em>高级模式</em> 中，关键字显示为单独的元素，正则表达式会以不同的高亮方式显示。此控件支持编辑和删除关键字。你可以通过控件内的按钮在两种模式间切换。</p></div><div class="el-p"><p dir="auto">可选过滤器：一组辅助关键字，用来与主要关键字一起使用。请参见<a data-tooltip-position="top" aria-label="2.7 世界书（World Info） > 可选过滤器" data-href="2.7 世界书（World Info）#可选过滤器" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#可选过滤器_0" class="internal-link" target="_self" rel="noopener nofollow">可选过滤器</a>。这些关键字也支持<a data-tooltip-position="top" aria-label="2.7 世界书（World Info） > 正则表达式（Regex）作为关键词" data-href="2.7 世界书（World Info）#正则表达式（Regex）作为关键词" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#正则表达式（Regex）作为关键词_0" class="internal-link" target="_self" rel="noopener nofollow">正则表达式</a>。</p></div><div class="el-h4"><h4 data-heading="条目内容" dir="auto" class="heading" id="条目内容_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>条目内容</h4></div><div class="el-p"><p dir="auto">当条目被触发时，插入到提示词中的文本。</p></div><div class="el-h4"><h4 data-heading="插入顺序" dir="auto" class="heading" id="插入顺序_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>插入顺序</h4></div><div class="el-p"><p dir="auto">数值，定义条目的优先级。如果多条条目被同时触发，插入顺序较高的条目会更靠近提示词的末尾，因而对输出影响更大。</p></div><div class="el-h4"><h4 data-heading="插入位置" dir="auto" class="heading" id="插入位置_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>插入位置</h4></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><strong>角色定义前：</strong> 世界书条目在角色描述和场景之前插入，对对话有中等影响。</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><strong>角色定义后：</strong> 世界书条目在角色描述和场景之后插入，对对话有更大影响。</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span><strong>示例消息前：</strong> 世界书条目作为示例对话块，在角色卡片的示例消息之前插入。</li>
<li data-line="3" dir="auto"><span class="list-bullet"></span><strong>示例消息后：</strong> 世界书条目作为示例对话块，在角色卡片的示例消息之后插入。</li>
<li data-line="4" dir="auto"><span class="list-bullet"></span><strong>作者注释顶部：</strong> 世界书条目插入到作者注释的顶部。根据作者注释的位置，这会对对话产生不同的影响。</li>
<li data-line="5" dir="auto"><span class="list-bullet"></span><strong>作者注释底部：</strong> 世界书条目插入到作者注释的底部。根据作者注释的位置，这会对对话产生不同的影响。</li>
<li data-line="6" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>@ D：</strong> 世界书条目插入到聊天的特定深度（深度 0 表示提示词的底部）。
<ul class="has-list-bullet">
<li data-line="7" dir="auto"><span class="list-bullet"></span>⚙️ - 作为系统角色消息</li>
<li data-line="8" dir="auto"><span class="list-bullet"></span>👤 - 作为用户角色消息</li>
<li data-line="9" dir="auto"><span class="list-bullet"></span>🤖 - 作为助手角色消息</li>
</ul>
</li>
</ul></div><div class="el-p"><p dir="auto">示例消息条目将根据提示词构建设置进行格式化：指令模式或聊天补全提示词管理器。它们还遵循示例消息行为规则：逐渐被完整上下文推移、始终保留或完全禁用。</p></div><div class="el-p"><p dir="auto">如果你的作者注释被禁用（插入频率 = 0），那么位置为作者注释的世界书条目将被忽略！</p></div><div class="el-h4"><h4 data-heading="条目标题 / 备注" dir="auto" class="heading" id="条目标题_/_备注_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>条目标题 / 备注</h4></div><div class="el-p"><p dir="auto">一个文本字段，用于方便你标记条目，AI 或任何触发逻辑不会使用该字段。</p></div><div class="el-p"><p dir="auto">如果为空，可以通过点击“填充空白备注”按钮，使用条目的第一个关键字来自动填充备注。</p></div><div class="el-h4"><h4 data-heading="策略" dir="auto" class="heading" id="策略_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>策略</h4></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">🔵（蓝色圆圈） = 该条目在提示词中始终存在。</li>
<li data-line="1" dir="auto">🟢（绿色圆圈） = 该条目仅在出现特定关键词时触发。</li>
<li data-line="2" dir="auto">🔗（链环） = 该条目允许通过嵌入相似性插入。</li>
</ol></div><div class="el-p"><p dir="auto">每个条目还具有一个开关，用于启用或禁用该条目。</p></div><div class="el-h4"><h4 data-heading="可选过滤器" dir="auto" class="heading" id="可选过滤器_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>可选过滤器</h4></div><div class="el-p"><p dir="auto">逗号分隔的附加关键词，与主关键词一起使用。 如果未提供参数，则此标志将被忽略。 支持 AND ANY、AND ALL、NOT ANY 或 NOT ALL 的逻辑。</p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">AND ANY = 仅在主关键词和任意一个附加关键词同时出现在扫描上下文中时，才会激活该条目。</li>
<li data-line="1" dir="auto">AND ALL = 仅在主关键词和所有附加关键词同时出现在扫描上下文中时，才会激活该条目。</li>
<li data-line="2" dir="auto">NOT ANY = 仅在主关键词和没有任何附加关键词出现在扫描上下文中时，才会激活该条目。</li>
<li data-line="3" dir="auto">NOT ALL = 即使主关键词触发，也会阻止该条目激活，若所有附加关键词都出现在扫描上下文中。</li>
</ol></div><div class="el-h4"><h4 data-heading="触发概率（Trigger %）" dir="auto" class="heading" id="触发概率（Trigger_%）_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>触发概率（Trigger %）</h4></div><div class="el-p"><p dir="auto">该值充当附加过滤器，增加了在通过任何方式（常量、主关键词、递归）激活时，某些条目未被插入的机会。</p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">概率 = 100 表示每次激活时都会插入该条目。</li>
<li data-line="1" dir="auto">概率 = 50 表示该条目有 50%的概率被插入。</li>
<li data-line="2" dir="auto">概率 = 0 表示该条目不会被插入（实际上禁用了该条目）。</li>
</ol></div><div class="el-p"><p dir="auto">使用此功能来创建聊天中的随机事件。例如，每条消息可能有 1%的几率唤醒一位古老的神明（如果其名字出现在消息中）。</p></div><div class="el-h4"><h4 data-heading="包含组（Inclusion Group）" dir="auto" class="heading" id="包含组（Inclusion_Group）_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>包含组（Inclusion Group）</h4></div><div class="el-p"><p dir="auto">包含组控制当多个条目具有相同组标签时，它们如何被同时选择。当多个条目同时被激活并且它们属于同一组标签时，只有一个条目会被插入到提示词中。</p></div><div class="el-p"><p dir="auto">默认情况下，所选条目根据其组权重（默认值为 100 分）随机选择，分值越高，选择的概率越大。这使得在多个触发条目之间增加了惊喜和变化的元素。</p></div><div class="el-p"><p dir="auto">一个条目可以属于多个包含组（通过逗号分隔）。如果激活了其中任何一个组，所有与之关联的其他条目都将被禁用。因此，如果激活了任何一个组，则该条目不会被激活。</p></div><div class="el-h4"><h4 data-heading="优先选择包含项（Prioritize Inclusion）" dir="auto" class="heading" id="优先选择包含项（Prioritize_Inclusion）_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>优先选择包含项（Prioritize Inclusion）</h4></div><div class="el-p"><p dir="auto">通过[包含组]（/Usage/worldinfo.md#inclusion-group），该选项允许您确定性地控制在多个条目同时激活时选择哪个条目，而不是随机选择。</p></div><div class="el-p"><p dir="auto">如果多个条目属于相同的组标签并且启用了此设置，当它们都被激活时，具有最高“顺序”值的条目将被选中。这对于通过包含组创建回退序列非常有用。例如，当低层次条目更重要时，可以优先选择它们；或者如果多个条目都有效，可以优先选择某个特定的指令来设定场景。</p></div><div class="el-h4"><h4 data-heading="使用组评分（Use Group Scoring）" dir="auto" class="heading" id="使用组评分（Use_Group_Scoring）_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>使用组评分（Use Group Scoring）</h4></div><div class="el-p"><p dir="auto">当此设置全局或每个条目启用时，已激活的条目键的数量决定了组选择的胜出者。只有匹配最多键的组子集将根据组权重或包含优先级被激活——其他的将被禁用并从组中移除。</p></div><div class="el-p"><p dir="auto">此功能用于在大型组中为个别条目提供更高的特异性。例如，它们可能具有共同的关键词和特定的关键词。当特定的关键词没有提供时，随机条目会被插入，反之亦然。</p></div><div class="el-p"><p dir="auto">主关键词的得分计算方式是：1 个匹配 = 1 分。</p></div><div class="el-p"><p dir="auto">对于次要关键词，交互取决于所选择的选择逻辑：</p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">AND ANY: 每个次要关键词匹配 1 分。</li>
<li data-line="1" dir="auto">AND ALL: 如果所有次要关键词都匹配，则每个次要关键词得 1 分。</li>
<li data-line="2" dir="auto">NOT ANY 和 NOT ALL: 不做更改。</li>
</ol></div><div class="el-p"><p dir="auto">例如：</p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>条目 1. 关键词：song，sing，Black Cat。组：songs</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>条目 2. 关键词：song，sing，Ghosts。组：songs</li>
</ul></div><div class="el-p"><p dir="auto">输入 <code>sing me a song</code> 可以激活任意一个条目（两个条目各激活了 2 个关键词），但 <code>sing me a song about Ghosts</code> 将只激活条目 2（激活了 3 个关键词）。</p></div><div class="el-h4"><h4 data-heading="自动化 ID（Automation ID）" dir="auto" class="heading" id="自动化_ID（Automation_ID）_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>自动化 ID（Automation ID）</h4></div><div class="el-p"><p dir="auto">允许将世界书条目与<a data-tooltip-position="top" aria-label="https://for_contributors/st-script.md" rel="noopener nofollow" class="external-link is-unresolved" href="https://for_contributors/st-script.md" target="_self">快速回复扩展</a>中的 ST 脚本集成。如果快速回复命令和世界书条目具有相同的自动化 ID，当匹配的条目被激活时，命令将自动执行。</p></div><div class="el-p"><p dir="auto">自动化命令将按照触发顺序执行，遵循您的指定排序策略，结合<a data-tooltip-position="top" aria-label="2.7 世界书（World Info） > 角色背景资料插入策略" data-href="2.7 世界书（World Info）#角色背景资料插入策略" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#角色背景资料插入策略_0" class="internal-link" target="_self" rel="noopener nofollow">角色背景资料插入策略</a>和“优先级”排序。递归触发的条目将在相同顺序下按优先级处理。</p></div><div class="el-p"><p dir="auto">如果具有相同自动化 ID 的多个条目被激活，则该命令只会执行一次。</p></div><div class="el-h1"><h1 data-heading="向量存储匹配" dir="auto" class="heading" id="向量存储匹配_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>向量存储匹配</h1></div><div class="el-p"><p dir="auto">向量存储扩展提供了一个替代关键词匹配的方法，通过使用最近聊天消息与世界书条目内容之间的相似度进行匹配。</p></div><div class="el-p"><p dir="auto">启用和使用此功能需要满足以下先决条件：</p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">向量存储扩展已启用，并配置为使用可用的嵌入源之一。</li>
<li data-line="1" dir="auto">在向量存储扩展设置中勾选了“启用世界书匹配”复选框。</li>
<li data-line="2" dir="auto">允许无密钥匹配的世界书条目必须具有“已向量化”（🔗）状态，或者在向量存储设置中勾选了“启用所有条目”选项。</li>
</ol></div><div class="el-p"><p dir="auto">扩展中向量化模型的选择以及“嵌入（embeddings）”这一术语的理论意义不在此讨论。如果需要更多关于此主题的信息，请参阅<a data-tooltip-position="top" aria-label="2.9.6 数据库（RAG）" data-href="2.9.6 数据库（RAG）" href="sillytavern/2-使用指南/2.9.6-数据库（rag）.html#_0" class="internal-link" target="_self" rel="noopener nofollow">数据库</a>指南。</p></div><div class="el-p"><p dir="auto">向量存储匹配遵循以下规则：</p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>允许通过向量存储匹配的最大条目数可以通过“最大条目数”设置进行调整。此数字仅设定限制，不影响在世界书激活设置中为条目设定的令牌预算。所有预算规则仍然适用。</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>此功能仅替代关键词检查。条目插入的其他检查条件仍需满足，例如触发百分比、角色过滤、包含组等。</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span>激活设置中的“扫描深度”设置或条目覆盖将不会被使用。向量存储“查询消息”值将用于与之匹配的文本。这允许进行类似“扫描深度”设置为 0 的配置，这样将不会执行常规的关键词匹配，但条目仍可通过向量激活。</li>
<li data-line="3" dir="auto"><span class="list-bullet"></span>“已向量化”状态仅是附加标记。条目仍会像普通的启用且非常量的记录那样，通过关键词触发。如果您希望条目仅通过向量激活，请移除关键词。</li>
</ul></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="warning" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-alert-triangle"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">Warning</div></div><div class="callout-content">
<p dir="auto">由于检索质量完全依赖于嵌入模型的输出，因此无法预测哪些条目将被插入。如果您希望得到确定性和可预测的结果，请坚持使用关键词匹配。</p>
</div></div></div><div class="el-h1"><h1 data-heading="定时效果" dir="auto" class="heading" id="定时效果_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>定时效果</h1></div><div class="el-p"><p dir="auto">通常情况下，世界书评估是无状态的，这意味着评估结果只依赖于当前的聊天上下文。然而，随着定时效果的引入，您可以创建具有激活延迟、在激活后保持有效或激活后无法再触发的条目。</p></div><div class="el-h2"><h2 data-heading="定时效果规则" dir="auto" class="heading" id="定时效果规则_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>定时效果规则</h2></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">效果的时间框架是以消息为单位进行衡量的（而不是消息对/交换），其中 0 意味着没有效果。</li>
<li data-line="1" dir="auto">效果仅适用于激活条目的聊天。分支继承父聊天的状态。</li>
<li data-line="2" dir="auto">如果聊天没有继续（例如，最后一条消息被删除或滑动），活动的定时效果将被移除。</li>
<li data-line="3" dir="auto">对当前处于定时效果中的条目进行任何更改将强制移除该效果。</li>
<li data-line="4" dir="auto">连续触发关键词不会刷新已激活效果的持续时间。</li>
</ol></div><div class="el-h2"><h2 data-heading="定时效果类型" dir="auto" class="heading" id="定时效果类型_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>定时效果类型</h2></div><div class="el-ol"><ol>
<li data-line="0" dir="auto"><strong>粘性效果（Sticky）</strong> – 激活后条目将在接下来的 N 条消息中保持激活状态。已粘贴的条目在后续扫描中将忽略概率检查，直到效果过期。</li>
<li data-line="1" dir="auto"><strong>冷却效果（Cooldown）</strong> – 激活后条目将在接下来的 N 条消息中无法再激活。可以与粘性效果一起使用：当粘性效果结束时，条目进入冷却状态。</li>
<li data-line="2" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>延迟效果（Delay）</strong> – 条目必须在聊天中至少有 N 条消息时才可激活。
<ul class="has-list-bullet">
<li data-line="3" dir="auto"><span class="list-bullet"></span>延迟 = 0 -&gt; 条目可以随时激活。</li>
<li data-line="4" dir="auto"><span class="list-bullet"></span>延迟 = 1 -&gt; 如果聊天为空（没有问候），则条目无法激活。</li>
<li data-line="5" dir="auto"><span class="list-bullet"></span>延迟 = 2 -&gt; 如果聊天中没有消息或仅有一条消息，条目无法激活，依此类推。</li>
</ul>
</li>
</ol></div><div class="el-h2"><h2 data-heading="定时效果示例" dir="auto" class="heading" id="定时效果示例_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>定时效果示例</h2></div><div class="el-p"><p dir="auto">条目配置：粘性 = 3，冷却 = 2，延迟 = 2。</p></div><div class="el-pre"><pre class="language-plain" tabindex="0"><code data-line="0" class="language-plain is-loaded">消息 0: 延迟
消息 1: 条目被激活
消息 2: 粘性
消息 3: 粘性
消息 4: 粘性
消息 5: 冷却
消息 6: 冷却
消息 7: 条目可以再次激活
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h1"><h1 data-heading="激活设置" dir="auto" class="heading" id="激活设置_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>激活设置</h1></div><div class="el-p"><p dir="auto">世界书界面顶部的可折叠菜单。</p></div><div class="el-h2"><h2 data-heading="扫描深度" dir="auto" class="heading" id="扫描深度_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>扫描深度</h2></div><div class="el-blockquote"><blockquote dir="auto">
<p>可以在条目级别覆盖。</p>
</blockquote></div><div class="el-p"><p dir="auto">定义聊天历史中应该扫描多少条消息来激活世界书条目。</p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>如果设置为 0，则仅评估递归条目和作者注释。</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>如果设置为 1，则只扫描最后一条消息。</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span>设置为 2，则扫描最近的两条消息，依此类推。</li>
</ul></div><div class="el-h2"><h2 data-heading="包含名称" dir="auto" class="heading" id="包含名称_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>包含名称</h2></div><div class="el-p"><p dir="auto">定义是否应将聊天参与者的名称作为消息前缀包含在扫描文本缓冲区中。这允许在没有直接提到名称的情况下，激活使用名称作为关键字的条目。</p></div><div class="el-p"><p dir="auto">以下是示例文本，假设聊天参与者为 Alice 和 Bob。</p></div><div class="el-p"><p dir="auto">启用（默认）：</p></div><div class="el-pre"><pre class="language-plain" tabindex="0"><code data-line="0" class="language-plain is-loaded">Alice: 你好！很高兴见到你。
Bob: 今天天气怎么样？
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">禁用：</p></div><div class="el-pre"><pre class="language-plain" tabindex="0"><code data-line="0" class="language-plain is-loaded">你好！很高兴见到你。
今天天气怎么样？
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h2"><h2 data-heading="上下文百分比 / 预算" dir="auto" class="heading" id="上下文百分比_/_预算_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>上下文百分比 / 预算</h2></div><div class="el-p"><p dir="auto"><strong>定义一次性使用多少标记（tokens）来激活世界书条目。</strong> 可以根据 API 的最大上下文设置（上下文百分比）或目标标记阈值（预算）定义一个阈值。</p></div><div class="el-p"><p dir="auto">如果预算耗尽，则不会激活更多条目，即使在提示词中存在相应的关键字。</p></div><div class="el-p"><p dir="auto">常规条目将首先插入。然后是具有更高顺序号的条目。</p></div><div class="el-p"><p dir="auto">直接提及其关键字的条目具有比其他条目更高的优先级。</p></div><div class="el-h2"><h2 data-heading="最小激活数" dir="auto" class="heading" id="最小激活数_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>最小激活数</h2></div><div class="el-p"><p dir="auto"><strong>此设置与最大递归步骤互斥。</strong></p></div><div class="el-p"><p dir="auto">最小激活数：如果设置为非零值，这将忽略“扫描深度”限制，从最新消息开始回溯聊天记录，直到触发指定数量的条目。这仍然会受到最大深度设置或整体预算上限的限制。</p></div><div class="el-p"><p dir="auto"><em>由最小激活数触发的额外扫描将不会检查递归中前一步添加的条目。只有聊天消息和扩展提示可以触发这些额外的激活。然而，由最小激活数触发的条目可以像平常一样触发其他条目。</em></p></div><div class="el-h2"><h2 data-heading="最大深度" dir="auto" class="heading" id="最大深度_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>最大深度</h2></div><div class="el-p"><p dir="auto">使用最小激活数设置时，扫描的最大深度。</p></div><div class="el-h2"><h2 data-heading="递归扫描" dir="auto" class="heading" id="递归扫描_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>递归扫描</h2></div><div class="el-p"><p dir="auto">递归扫描允许条目激活其他条目或被其他条目激活，从而增强不同世界书条目之间的动态互动和依赖关系。此功能可以显著提升你创作场景的复杂性和互动性。</p></div><div class="el-p"><p dir="auto">递归扫描是否启用可以通过全局设置 <strong>递归扫描</strong> 来控制。</p></div><div class="el-p"><p dir="auto">有三种选项可用于控制每个条目的递归行为：</p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><strong>不可递归</strong>：选中此选项后，条目将不会被其他条目激活。这对于那些不应改变或不受其他世界书条目影响的静态信息非常有用。</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><strong>防止进一步递归</strong>：选中此选项后，激活该条目后将不会触发任何其他条目。这有助于避免意外的递归链式触发。</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span><strong>延迟至递归时激活</strong>：该条目仅在递归检查期间激活，意味着它在初始扫描时不会被触发，但可以被启用递归的其他条目激活。现在，加入了 <strong>递归层级</strong> 的延迟功能，条目按层级分组。最初，只会匹配第一级（最小的数字）。一旦没有找到匹配项，下一个层级才会被检查，直到所有层级都被检查为止。这允许更精细地控制何时及如何在递归过程中揭示更深层次的信息，特别是在与“任何都不”或“并非全部”组合条件一起使用时。</li>
</ul></div><div class="el-p"><p dir="auto"><strong>条目可以通过在内容文本中提及其关键字来激活其他条目。</strong></p></div><div class="el-p"><p dir="auto">例如，如果你的世界书中有两个条目：</p></div><div class="el-pre"><pre class="language-plain" tabindex="0"><code data-line="0" class="language-plain is-loaded">条目 #1
关键字：Bessie
内容：Bessie 是一头牛，和 Rufus 是朋友。
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-plain" tabindex="0"><code data-line="0" class="language-plain is-loaded">条目 #2
关键字：Rufus
内容：Rufus 是一只狗。
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>如果消息文本仅提到 Bessie</strong>，则两个条目都会被拉入上下文中。</p></div><div class="el-h2"><h2 data-heading="最大递归步骤" dir="auto" class="heading" id="最大递归步骤_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>最大递归步骤</h2></div><div class="el-p"><p dir="auto"><strong>此设置与最小激活数互斥。</strong></p></div><div class="el-p"><p dir="auto">当设置为零时，递归嵌套仅受限于提示词的预算。当设置为非零值时，限制扫描步骤的总数，即递归的最大“嵌套层级”。</p></div><div class="el-p"><p dir="auto">示例值：</p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>1 实际上禁用了递归，因为检查在第一步后停止。</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>2 只能激活递归条目一次。</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span>3 可以触发递归两次……</li>
</ul></div><div class="el-h2"><h2 data-heading="区分大小写的关键字" dir="auto" class="heading" id="区分大小写的关键字_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>区分大小写的关键字</h2></div><div class="el-blockquote"><blockquote dir="auto">
<p>可以在条目级别覆盖。</p>
</blockquote></div><div class="el-p"><p dir="auto"><strong>为了使条目被拉入上下文，关键字必须与世界书条目中定义的大小写完全匹配。</strong></p></div><div class="el-p"><p dir="auto">这对于关键字是常见词或常见词部分的条目非常有用。</p></div><div class="el-p"><p dir="auto">例如，当此设置启用时，'rose' 和 'Rose' 将被视为不同的关键字，具体取决于输入。</p></div><div class="el-h2"><h2 data-heading="匹配完整单词" dir="auto" class="heading" id="匹配完整单词_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>匹配完整单词</h2></div><div class="el-blockquote"><blockquote dir="auto">
<p>可以在条目级别覆盖。</p>
</blockquote></div><div class="el-p"><p dir="auto">仅当关键字包含一个单词时，才会在搜索文本中完全匹配该单词。默认启用。</p></div><div class="el-p"><p dir="auto">例如，如果此设置启用且条目关键字为“king”，则文本如“long live the king”将被匹配，但“it's not to my liking”则不会。</p></div><div class="el-p"><p dir="auto"><strong>重要提示</strong>：当用于不以空格分隔单词的语言（如日语或中文）时，此设置可能会产生不利影响。如果你在这些语言中编写条目，建议关闭此选项。</p></div><div class="el-h2"><h2 data-heading="溢出警报" dir="auto" class="heading" id="溢出警报_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>溢出警报</h2></div><div class="el-p"><p dir="auto">如果激活的世界书条目超出分配的标记预算，将显示警报。</p></div><div class="footer"><div class="data-bar"></div></div></div></div></div><div id="right-content" class="leaf" style="--sidebar-width: var(--sidebar-width-right);"><div id="right-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme-toggle-input" id=""><input class="theme-toggle-input" type="checkbox" id="theme-toggle-input"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="right-sidebar-content" class="leaf-content"><div class="graph-view-wrapper"><div class="feature-header"><div class="feature-title">Interactive Graph</div></div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<div class="graph-icon graph-global" role="button" aria-label="Global Graph" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-git-fork"><circle cx="12" cy="18" r="3"></circle><circle cx="6" cy="6" r="3"></circle><circle cx="18" cy="6" r="3"></circle><path d="M18 9v2c0 .6-.4 1-1 1H7c-.6 0-1-.4-1-1V9"></path><path d="M12 12v3"></path></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div id="outline" class=" tree-container"><div class="feature-header"><div class="feature-title">Table Of Contents</div><button class="clickable-icon nav-action-button tree-collapse-all" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#2.7_世界书（World_Info）_0" data-path="#2.7_世界书（World_Info）_0"><div class="tree-item-inner heading-link" heading-name="2.7 世界书（World Info）">2.7 世界书（World Info）</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#世界书（World_Info）_0" data-path="#世界书（World_Info）_0"><div class="tree-item-inner heading-link" heading-name="世界书（World Info）">世界书（World Info）</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#专业提示_0" data-path="#专业提示_0"><div class="tree-item-inner heading-link" heading-name="专业提示">专业提示</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#进一步阅读_0" data-path="#进一步阅读_0"><div class="tree-item-inner heading-link" heading-name="进一步阅读">进一步阅读</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#角色背景资料_0" data-path="#角色背景资料_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="角色背景资料">角色背景资料</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#角色背景资料插入策略_0" data-path="#角色背景资料插入策略_0"><div class="tree-item-inner heading-link" heading-name="角色背景资料插入策略">角色背景资料插入策略</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#平均排序（默认）_0" data-path="#平均排序（默认）_0"><div class="tree-item-inner heading-link" heading-name="平均排序（默认）">平均排序（默认）</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#角色背景资料优先_0" data-path="#角色背景资料优先_0"><div class="tree-item-inner heading-link" heading-name="角色背景资料优先">角色背景资料优先</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#全局背景资料优先_0" data-path="#全局背景资料优先_0"><div class="tree-item-inner heading-link" heading-name="全局背景资料优先">全局背景资料优先</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#世界书条目_0" data-path="#世界书条目_0"><div class="tree-item-inner heading-link" heading-name="世界书条目">世界书条目</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#关键字_0" data-path="#关键字_0"><div class="tree-item-inner heading-link" heading-name="关键字">关键字</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="5"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#正则表达式（Regex）作为关键词_0" data-path="#正则表达式（Regex）作为关键词_0"><div class="tree-item-inner heading-link" heading-name="正则表达式（Regex）作为关键词">正则表达式（Regex）作为关键词</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#每条消息匹配_高级正则表达式_0" data-path="#每条消息匹配_高级正则表达式_0"><div class="tree-item-inner heading-link" heading-name="每条消息匹配 高级正则表达式">每条消息匹配 高级正则表达式</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="5"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#关键字输入_0" data-path="#关键字输入_0"><div class="tree-item-inner heading-link" heading-name="关键字输入">关键字输入</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#条目内容_0" data-path="#条目内容_0"><div class="tree-item-inner heading-link" heading-name="条目内容">条目内容</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#插入顺序_0" data-path="#插入顺序_0"><div class="tree-item-inner heading-link" heading-name="插入顺序">插入顺序</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#插入位置_0" data-path="#插入位置_0"><div class="tree-item-inner heading-link" heading-name="插入位置">插入位置</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#条目标题_/_备注_0" data-path="#条目标题_/_备注_0"><div class="tree-item-inner heading-link" heading-name="条目标题 / 备注">条目标题 / 备注</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#策略_0" data-path="#策略_0"><div class="tree-item-inner heading-link" heading-name="策略">策略</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#可选过滤器_0" data-path="#可选过滤器_0"><div class="tree-item-inner heading-link" heading-name="可选过滤器">可选过滤器</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#触发概率（Trigger_%）_0" data-path="#触发概率（Trigger_%）_0"><div class="tree-item-inner heading-link" heading-name="触发概率（Trigger %）">触发概率（Trigger %）</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#包含组（Inclusion_Group）_0" data-path="#包含组（Inclusion_Group）_0"><div class="tree-item-inner heading-link" heading-name="包含组（Inclusion Group）">包含组（Inclusion Group）</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#优先选择包含项（Prioritize_Inclusion）_0" data-path="#优先选择包含项（Prioritize_Inclusion）_0"><div class="tree-item-inner heading-link" heading-name="优先选择包含项（Prioritize Inclusion）">优先选择包含项（Prioritize Inclusion）</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#使用组评分（Use_Group_Scoring）_0" data-path="#使用组评分（Use_Group_Scoring）_0"><div class="tree-item-inner heading-link" heading-name="使用组评分（Use Group Scoring）">使用组评分（Use Group Scoring）</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#自动化_ID（Automation_ID）_0" data-path="#自动化_ID（Automation_ID）_0"><div class="tree-item-inner heading-link" heading-name="自动化 ID（Automation ID）">自动化 ID（Automation ID）</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#向量存储匹配_0" data-path="#向量存储匹配_0"><div class="tree-item-inner heading-link" heading-name="向量存储匹配">向量存储匹配</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#定时效果_0" data-path="#定时效果_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="定时效果">定时效果</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#定时效果规则_0" data-path="#定时效果规则_0"><div class="tree-item-inner heading-link" heading-name="定时效果规则">定时效果规则</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#定时效果类型_0" data-path="#定时效果类型_0"><div class="tree-item-inner heading-link" heading-name="定时效果类型">定时效果类型</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#定时效果示例_0" data-path="#定时效果示例_0"><div class="tree-item-inner heading-link" heading-name="定时效果示例">定时效果示例</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#激活设置_0" data-path="#激活设置_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="激活设置">激活设置</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#扫描深度_0" data-path="#扫描深度_0"><div class="tree-item-inner heading-link" heading-name="扫描深度">扫描深度</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#包含名称_0" data-path="#包含名称_0"><div class="tree-item-inner heading-link" heading-name="包含名称">包含名称</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#上下文百分比_/_预算_0" data-path="#上下文百分比_/_预算_0"><div class="tree-item-inner heading-link" heading-name="上下文百分比 / 预算">上下文百分比 / 预算</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#最小激活数_0" data-path="#最小激活数_0"><div class="tree-item-inner heading-link" heading-name="最小激活数">最小激活数</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#最大深度_0" data-path="#最大深度_0"><div class="tree-item-inner heading-link" heading-name="最大深度">最大深度</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#递归扫描_0" data-path="#递归扫描_0"><div class="tree-item-inner heading-link" heading-name="递归扫描">递归扫描</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#最大递归步骤_0" data-path="#最大递归步骤_0"><div class="tree-item-inner heading-link" heading-name="最大递归步骤">最大递归步骤</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#区分大小写的关键字_0" data-path="#区分大小写的关键字_0"><div class="tree-item-inner heading-link" heading-name="区分大小写的关键字">区分大小写的关键字</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#匹配完整单词_0" data-path="#匹配完整单词_0"><div class="tree-item-inner heading-link" heading-name="匹配完整单词">匹配完整单词</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="sillytavern/2-使用指南/2.7-世界书（world-info）.html#溢出警报_0" data-path="#溢出警报_0"><div class="tree-item-inner heading-link" heading-name="溢出警报">溢出警报</div></a><div class="tree-item-children"></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector("#right-sidebar"); rs.classList.toggle("is-collapsed", window.innerWidth < 768); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></div></body></html>